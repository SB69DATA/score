WebAudio=new function(){window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=null,this.errorFlag=!1;try{this.audioContext=new window.AudioContext}catch(o){return console.error("WebAudioAPI未対応"),this.Sound=function(){},void(this.errorFlag=!0)}this.Sound=function(o){if(!(this instanceof WebAudio.Sound))return new WebAudio.Sound(o);var t=this;this.soundUrl=o,this.gainNode=WebAudio.audioContext.createGain(),this.loadFlag=!1,this.buffer=null,this.src=null,this.onload=null,this.error=null,this.loop=!1;var e=new XMLHttpRequest;e.open("GET",this.soundUrl,!0),e.responseType="arraybuffer",e.onload=function(){WebAudio.audioContext.decodeAudioData(e.response,function(o){return o?(t.buffer=o,t.loadFlag=!0,void(null!==t.onload&&t.onload())):void console.error("デコードエラー1("+t.soundUrl+")")},function(o){console.error("デコードエラー2("+t.soundUrl+")"),null!==t.error&&t.error()})},e.onerror=function(){console.error("読み込みエラー("+t.soundUrl+")"),null!==t.error&&t.error()};try{e.send()}catch(n){throw console.error("読み込みエラー("+this.soundUrl+")"),n}}},WebAudio.Sound.prototype.loadState=function(){return this.errorFlag===!0?0:this.loadFlag?1:0},WebAudio.Sound.prototype.play=function(o,t){this.errorFlag!==!0&&this.loadFlag!==!1&&("undefined"==typeof o&&(o=0),"undefined"==typeof t&&(t=0),this.src=WebAudio.audioContext.createBufferSource(),this.src.buffer=this.buffer,this.src.connect(this.gainNode),this.gainNode.connect(WebAudio.audioContext.destination),this.src.loop=this.loop,this.src.loop?this.src.start(o+WebAudio.audioContext.currentTime):this.src.start(o+WebAudio.audioContext.currentTime,t))},WebAudio.Sound.prototype.setVolume=function(o){this.errorFlag!==!0&&(0>o&&(o=0),o>2&&(o=2),this.gainNode.gain.value=Math.pow(100,o)/100)},WebAudio.Sound.prototype.pause=function(o){this.errorFlag!==!0&&this.loadFlag!==!1&&null!==this.src&&("undefined"==typeof o&&(o=0),this.src.stop(o+WebAudio.audioContext.currentTime))};